<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Mashhad Sky: Jan 22, 2024</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600&family=Vazirmatn:wght@300;700&display=swap" rel="stylesheet">
<style>
    :root { --bg: #020408; --accent: #00d2ff; }
    body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); overflow: hidden; font-family: 'Vazirmatn', sans-serif; }
    canvas { display: block; position: absolute; top: 0; left: 0; z-index: 1; }
    
    /* UI Elements */
    .ui-overlay {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        display: flex; flex-direction: column; justify-content: center; align-items: center;
        z-index: 10; pointer-events: none; color: white;
        transition: opacity 1.5s ease-in-out;
    }
    .main-title {
        font-size: 3.5rem; font-weight: 700; text-shadow: 0 0 25px rgba(0, 210, 255, 0.7);
        margin: 0; opacity: 0; animation: fadeInSlow 3s forwards 0.5s;
    }
    .sub-data {
        font-family: 'Montserrat', sans-serif; font-size: 1rem; color: var(--accent);
        background: rgba(0, 20, 40, 0.8); padding: 8px 20px; border-radius: 50px;
        border: 1px solid rgba(0, 210, 255, 0.3); margin-top: 20px;
        opacity: 0; animation: fadeInSlow 3s forwards 2s; letter-spacing: 1px;
    }
    .fade-out { opacity: 0 !important; }
    
    /* Start Button */
    #start-screen {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000;
        z-index: 100; display: flex; justify-content: center; align-items: center;
        transition: opacity 1s ease-out;
    }
    .init-btn {
        background: transparent; border: 2px solid var(--accent); color: var(--accent);
        padding: 15px 50px; font-size: 1.2rem; cursor: pointer; transition: 0.4s;
        font-family: 'Montserrat', sans-serif; letter-spacing: 3px; border-radius: 4px;
    }
    .init-btn:hover { background: var(--accent); color: #000; box-shadow: 0 0 40px var(--accent); }
    @keyframes fadeInSlow { to { opacity: 1; } }
</style>
</head>
<body>

    <div id="start-screen">
        <button class="init-btn" onclick="beginJourney()">INITIALIZE SEQUENCE</button>
    </div>

    <div class="ui-overlay" id="main-ui">
        <h1 class="main-title">اسم پارتنر شما</h1>
        <div class="sub-data">MASHHAD · 2024-01-22 · 21:00:00 UTC+03:30</div>
    </div>

    <canvas id="skyCanvas"></canvas>

<script>
    // =====================================================================
    // 1. CONFIGURATION (تنظیمات دقیق)
    // =====================================================================
    const CONFIG = {
        // مختصات مشهد
        location: { lat: 36.2605, lng: 59.6168 }, 
        // تاریخ و ساعت دقیق: 22 ژانویه 2024، ساعت 9 شب به وقت محلی مشهد (UTC+3:30)
        // این زمان برای دیدن بهترین صورت‌های فلکی زمستانی (مثل جبار) عالی است.
        date: new Date("2024-01-22T21:00:00+03:30"),
        transitionDuration: 10000, // 10 ثانیه زمان تبدیل قلب به آسمان
        shootingStarDelay: 3000 // 3 ثانیه تاخیر بعد از تشکیل آسمان برای شهاب سنگ
    };

    // =====================================================================
    // 2. COMPRESSED STAR CATALOG (دیتاست فشرده 600+ ستاره پرنور)
    // format: [RA(hours), Dec(degrees), Magnitude, B-V Index]
    // =====================================================================
    const STAR_DATA = [
    [6.75,-16.7,-1.46,0.00],[14.26,19.2,-0.05,1.23],[5.24,-8.2,0.13,-0.03],[18.62,38.8,0.03,0.00],[5.27,46.0,0.08,0.80],[7.65,5.2,0.34,0.42],[5.92,7.4,0.50,1.85],[19.85,8.9,0.76,0.22],[4.60,16.5,0.87,1.54],[13.42,-11.2,0.98,-0.23],[16.49,-26.4,0.96,1.83],[7.76,28.0,1.14,1.00],[20.69,45.3,1.25,0.09],[22.96,-29.6,1.17,0.09],[10.14,12.0,1.36,-0.11],[2.53,89.3,1.97,0.60],[5.68,-1.9,1.74,-0.21],[5.60,-1.2,1.69,-0.19],[5.53,-0.3,2.25,-0.22],[11.06,61.8,1.79,1.07],[11.03,56.4,2.34,0.00],[13.79,49.3,1.85,-0.19],[0.67,56.5,2.24,1.17],[0.15,59.2,2.28,0.38],[2.31,89.3,1.97,0.64],[0.13,59.2,2.27,0.35],[0.67,56.5,2.23,1.19],[0.94,60.7,2.14,-0.04],[1.32,60.2,2.64,0.11],[1.90,63.7,3.34,0.09],[1.48,57.8,3.44,-0.09],[0.78,51.3,3.66,0.29],[2.06,42.3,1.79,0.13],[2.78,49.2,3.98,0.95],[3.08,40.9,3.51,1.68],[3.23,49.9,3.00,0.06],[3.40,47.8,2.92,-0.01],[3.90,35.6,2.85,-0.11],[4.05,47.7,3.94,0.07],[3.76,24.1,3.69,0.08],[3.78,24.5,2.83,0.08],[3.80,24.4,2.95,0.10],[3.81,24.2,3.60,0.07],[3.93,23.1,4.23,-0.07],[4.36,15.6,3.84,-0.03],[4.47,19.1,3.93,0.45],[4.60,16.5,0.85,1.54],[5.09,28.0,3.95,0.99],[5.11,18.3,3.67,-0.15],[5.17,21.6,4.26,-0.07],[5.20,33.4,4.28,1.08],[5.23,25.1,3.00,-0.10],[5.24,-8.2,0.12,-0.03],[5.27,45.9,0.08,0.80],[5.33,21.9,3.51,1.31],[5.41,-1.9,3.77,-0.18],[5.42,-4.8,2.75,1.61],[5.48,-6.4,4.11,-0.06],[5.52,-5.9,3.57,1.39],[5.53,-0.3,2.23,-0.22],[5.56,29.0,3.94,0.13],[5.59,37.2,3.61,-0.12],[5.60,-1.2,1.70,-0.19],[5.68,-1.9,1.77,-0.21],[5.68,0.2,3.66,-0.15],[5.79,-2.4,2.05,-0.18],[5.83,-9.7,2.06,-0.13],[5.92,7.4,0.50,1.86],[5.92,37.2,3.37,1.10],[5.99,-7.2,4.18,-0.11],[5.99,44.9,3.36,-0.07],[6.02,-10.7,4.12,-0.02],[6.03,10.0,4.22,0.03],[6.10,20.5,3.90,0.58],[6.24,-6.7,3.67,-0.02],[6.33,22.5,2.92,0.01],[6.37,16.4,4.41,0.05],[6.38,14.2,4.19,1.59],[6.45,-16.7,-1.46,0.00],[6.57,25.2,4.31,0.04],[6.63,6.1,3.38,1.02],[6.73,17.9,4.22,-0.03],[6.75,-12.1,4.08,-0.11],[6.75,38.7,4.03,-0.03],[6.77,13.2,3.17,0.01],[6.81,-28.9,1.50,-0.21],[6.96,33.1,3.54,0.52],[7.00,-26.3,1.84,1.64],[7.02,12.9,3.55,0.58],[7.03,-23.8,3.02,-0.15],[7.06,20.6,4.04,0.07],[7.12,22.1,3.60,0.48],[7.15,-15.6,3.93,0.03],[7.17,-27.9,3.86,-0.12],[7.23,16.5,3.53,0.07],[7.28,31.9,3.57,0.06],[7.30,21.1,3.53,-0.06],[7.33,-29.3,2.44,-0.11],[7.39,-14.8,3.87,0.05],[7.40,-23.5,3.78,-0.10],[7.42,24.4,3.41,1.08],[7.57,31.9,1.58,0.03],[7.65,5.2,0.37,0.42],[7.75,-12.3,4.10,-0.04],[7.76,28.0,1.15,0.99],[7.79,-21.8,4.11,0.15],[7.97,-14.6,4.15,1.46],[7.97,12.1,3.69,-0.09],[7.97,2.8,3.63,0.47],[8.00,-12.5,4.07,1.12],[8.04,1.7,4.22,-0.11],[8.07,6.4,3.97,0.33],[8.16,-24.3,4.04,-0.14],[8.16,17.7,3.83,-0.08],[8.17,-13.0,2.23,-0.04],[8.18,11.8,3.32,0.00],[8.20,2.1,4.19,-0.09],[8.21,-40.0,2.70,-0.11],[8.27,23.3,3.93,0.11],[8.30,60.7,3.36,1.50],[8.45,21.5,4.14,0.02],[8.46,18.4,4.32,1.10],[8.54,-2.4,3.77,-0.03],[8.60,19.0,3.61,1.03],[8.66,-36.4,4.27,1.12],[8.72,-33.2,4.24,1.41],[8.74,-42.3,2.21,-0.16],[8.75,6.1,4.30,0.36],[8.75,42.1,4.21,-0.01],[8.77,-40.6,3.58,0.97],[8.79,48.1,4.42,-0.07],[8.84,-32.2,3.90,0.96],[8.97,6.4,4.09,-0.03],[8.99,37.0,4.11,0.94],[9.03,47.2,3.12,0.08],[9.11,-14.8,4.03,1.63],[9.14,-43.4,3.87,0.31],[9.16,-5.0,4.02,-0.06],[9.17,-10.9,4.14,0.05],[9.23,-2.0,4.38,0.44],[9.31,-8.7,4.30,1.63],[9.36,9.0,4.20,-0.07],[9.40,-23.1,4.10,0.43],[9.46,-10.0,3.22,1.33],[9.51,-23.8,4.31,0.06],[9.52,-3.5,4.27,-0.04],[9.54,51.7,3.68,0.97],[9.67,-40.4,3.91,0.94],[9.75,26.0,3.06,0.96],[9.83,7.4,4.20,1.51],[9.83,13.8,4.16,0.08],[9.87,-7.5,3.17,0.93],[9.90,-7.8,3.99,-0.07],[10.00,-21.2,3.94,0.05],[10.13,23.4,4.01,0.91],[10.13,7.0,3.84,-0.06],[10.14,12.0,1.35,-0.11],[10.25,21.9,4.40,-0.12],[10.31,16.7,3.43,-0.06],[10.33,28.5,3.96,-0.02],[10.33,41.5,3.49,-0.02],[10.36,-13.1,3.80,-0.06],[10.54,24.9,4.35,1.51],[10.75,8.9,3.83,-0.06],[10.83,25.0,4.05,0.95],[10.83,5.6,3.59,0.14],[11.03,56.4,2.37,0.00],[11.06,61.8,1.79,1.07],[11.16,15.4,3.30,0.09],[11.16,20.5,4.46,0.01],[11.24,10.5,2.56,0.09],[11.27,2.8,4.27,0.03],[11.31,31.5,4.12,-0.05],[11.32,-18.0,3.79,-0.12],[11.40,-6.8,3.60,0.02],[11.42,20.1,4.33,1.14],[11.56,-16.9,4.08,-0.14],[11.60,2.0,4.01,0.46],[11.68,14.6,3.92,0.96],[11.76,-28.0,2.98,0.09],[11.78,27.2,4.02,0.10],[11.81,-10.3,3.48,1.30],[11.83,15.9,3.34,0.01],[11.85,-20.3,4.01,-0.03],[11.87,8.8,3.35,0.02],[11.90,53.7,2.44,0.00],[12.12,-17.5,2.95,0.02],[12.25,57.0,3.31,0.08],[12.28,23.4,4.17,0.09],[12.33,-8.2,3.73,0.39],[12.36,26.7,4.13,0.03],[12.48,-16.0,2.77,1.04],[12.51,-13.1,3.90,-0.06],[12.52,25.1,4.30,0.97],[12.56,17.4,3.96,-0.05],[12.61,21.4,3.50,0.13],[12.67,-12.7,4.31,-0.14],[12.69,22.9,3.60,-0.01],[12.75,-0.7,3.88,-0.15],[12.88,3.4,2.74,-0.01],[12.90,56.0,1.77,-0.02],[12.91,4.9,4.21,0.46],[12.97,-23.4,4.25,0.09],[13.00,11.0,2.83,0.06],[13.04,28.0,4.17,-0.07],[13.12,17.5,4.15,0.94],[13.13,20.6,4.19,0.93],[13.18,-18.5,2.64,0.03],[13.40,54.9,2.27,0.02],[13.42,-11.2,0.97,-0.23],[13.61,-10.6,4.40,0.06],[13.79,49.3,1.86,-0.19],[13.81,-15.9,3.52,1.01],[13.83,1.4,3.05,-0.08],[13.83,21.2,4.00,0.00],[14.03,51.4,3.67,1.40],[14.11,-13.4,2.99,0.96],[14.14,-26.7,2.75,0.08],[14.23,-12.0,3.85,1.01],[14.26,19.2,-0.04,1.23],[14.32,38.3,4.26,0.03],[14.40,49.7,4.13,1.44],[14.54,13.7,3.90,0.34],[14.60,12.3,3.99,0.06],[14.70,27.1,3.47,0.35],[14.72,46.3,3.50,0.03],[14.73,1.1,4.28,0.50],[14.77,-21.4,3.60,0.97],[14.78,-25.2,3.71,-0.06],[14.82,-16.0,2.56,-0.13],[14.85,74.2,2.08,0.12],[14.94,-28.8,3.29,0.05],[15.07,40.4,3.48,0.96],[15.07,47.7,4.21,0.93],[15.14,26.9,3.
